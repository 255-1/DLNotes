+ ***[Self-supervised Graph Learning for Recommendation(SGL)](https://dl.acm.org/doi/abs/10.1145/3404835.3462862)***   

![image-20220901140709165](https://paperrecord.oss-cn-shanghai.aliyuncs.com/image-20220901140709165.png)

**å¹´ä»½**ï¼š  2021

**å¼•ç”¨æ¬¡æ•°**ï¼š 132

**åº”ç”¨é¢†åŸŸ**ï¼š  å¯¹æ¯”å­¦ä¹ æ¨èç³»ç»Ÿ,  åŸºäºCF

**æ–¹æ³•åŠä¼˜ç¼ºç‚¹**ï¼š

ä½œè€…è®¤ä¸º[LightGCN](./LightGCN.md)å’Œ[PinSage](./PinSage.md)æœ‰ä¸¤ä¸ªé™åˆ¶, é«˜åº¦æ•°èŠ‚ç‚¹åœ¨ç‰¹å¾å­¦ä¹ ä¸Šä½œç”¨æ›´å¼º. æŸå®³äº†ä½åº¦æ•°èŠ‚ç‚¹çš„ç‰¹å¾å­¦ä¹ , å…¶æ¬¡, ç‰¹å¾å®¹æ˜“å—åˆ°å™ªå£°å½±å“, ç”±äºaggçš„æ–¹æ¡ˆä¼šæ‰©å¤§è§‚å¯Ÿåˆ°çš„è¾¹çš„å½±å“. æ‰€ä»¥ä¸ºäº†åŠ å¼ºé²æ£’æ€§å’Œå‡†ç¡®åº¦å¢åŠ äº†è¾…åŠ©çš„è‡ªç›‘ç£ä»»åŠ¡, è®¾è®¡äº†ä¸‰ç§ç”Ÿæˆè§†è§’, **node dropout, edge dropout, random walk**, é™¤æ­¤ä»¥å¤–ä½œè€…è¿˜å‘ç°ä½¿ç”¨ç¡¬è´Ÿæ ·æœ¬ä¼šæœ‰å…¶ä»–ä½œç”¨, ä¸ä»…æå‡äº†æ¨¡å‹è¡¨ç°è¿˜åŠ é€Ÿäº†è®­ç»ƒè¿‡ç¨‹.

**åŠ¨æœº**:  

GCNåªæœ‰ç¨€ç–çš„ç›‘ç£ä¿¡å·, æ­ªæ›²çš„æ•°æ®åˆ†å¸ƒ, ä»¥åŠäº¤äº’çš„å™ªå£°ç­‰é—®é¢˜, æå‡ºäº†SGLæ¨¡å‹, æœ¬æ¨¡å‹æ˜¯æ¨¡å‹æ— å…³çš„å¯ä»¥ä½¿ç”¨å…¶ä»–çš„GNNæ¨¡å‹, åªæ˜¯åœ¨æœ¬è®ºæ–‡ä¸­ä½¿ç”¨çš„æ˜¯LightGCNæ¨¡å‹.

**ç›¸å…³å·¥ä½œå’Œç†è®º**ï¼š  

ä½¿ç”¨çš„mainå‡½æ•°å°±æ˜¯pairwiseçš„BPR loss, å…¬å¼å¦‚ä¸‹æ‰€ç¤º.
$$
\mathcal L_{main} = \sum_{(u,i,j)\in O} - log\sigma(\hat{y}_{ui}-\hat{y}_uj)
$$
ä½¿ç”¨çš„æ•°æ®å¢å¼ºå¦‚ä¸‹:

**Node Dropout(ND)**:  $M', M''\in \{0,1\}^{|\mathcal V|}$æ˜¯ä¸¤ä¸ªmaskèŠ‚ç‚¹çš„å‘é‡å»ç”Ÿæˆä¸åŒçš„å­å›¾
$$
s_1(\mathcal G) = (M'\odot \mathcal V, \mathcal E), s_2(\mathcal G) =(M''\odot \mathcal V, \mathcal E),
$$
**Edge Dropout(ED)**:$M_1, M_2\in \{0,1\}^{|\mathcal E|}$æ˜¯ä¸¤ä¸ªmaskè¾¹çš„å‘é‡å»ç”Ÿæˆä¸åŒçš„å­å›¾
$$
s_1(\mathcal G) = (\mathcal V, M_1 \odot \mathcal E), s_2(\mathcal G) =(\mathcal V, M_2 \odot \mathcal E),
$$
**Random Walk(RW)**: ä¸Šé¢ä¸¤ä¸ªæ“ä½œç”Ÿæˆçš„å­å›¾åœ¨æ‰€æœ‰å±‚å…±äº«, RWæ˜¯åœ¨æ¯ä¸€å±‚æœ‰ä¸åŒçš„maskè¾¹å‘é‡, å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥æ¨¡æ‹ŸRW.
$$
s_1(\mathcal G) = (\mathcal V, M_1^{(l)} \odot \mathcal E), s_2(\mathcal G) =(\mathcal V, M_2^{(l)} \odot \mathcal E),
$$
æ¥ç€æ˜¯å¯¹æ¯”å­¦ä¹ çš„å†…å®¹, ä½¿ç”¨çš„å°±æ˜¯InfoNCEçš„å…¬å¼ æ¯”è¾ƒçš„å°±æ˜¯åŠ å¼ºåçš„ä¸¤ä¸ªè§†è§’ä¸‹çš„ç›¸ä¼¼åº¦, $\mathcal L_{ssl}^{item}$åŒç†, $\mathcal L_{ssl}=\mathcal L_{ssl}^{item}+\mathcal L_{ssl}^{user}$
$$
\mathcal L_{ssl}^{user} = \sum_{u\in\mathcal U}-log\frac{exp(s(z_u', z_u'')/\tau)}{\sum_{v \in \mathcal U}exp(s(z_u', z_v'')/\tau)}
$$
å¤šä»»åŠ¡è®­ç»ƒçš„ç›®æ ‡å‡½æ•°å¦‚ä¸‹, åœ¨$\mathcal L_{ssl}$ä¸­é¢„è®­ç»ƒ, åœ¨$\mathcal L_{main}$ä¸­å¾®è°ƒ.
$$
\mathcal L = \mathcal L_{main}+\lambda_1\mathcal L_{ssl}+\lambda_2||\Theta||^2_2
$$
åé¢ä½œè€…ç†è®ºåˆ†æäº†ä¸ºä»€ä¹ˆç¡¬è´Ÿæ ·æœ¬åœ¨SGLä¸­æœ‰ç”¨çš„åŸå› , çœ‹ä¸æ‡‚, è¯´ç›´ç™½ç‚¹å°±æ˜¯ç¡¬è´Ÿæ ·æœ¬æä¾›æ›´å¤šçš„æ¢¯åº¦å¸®åŠ©è®­ç»ƒ

å¤§è‡´ç†è§£å¦‚ä¸‹, SSL Losså¯¹å‘é‡çš„æ¢¯åº¦ç»“æœå¦‚ä¸‹, å…¶ä¸­$c(v)$ä»£è¡¨äº†æ­£è´Ÿæ ·æœ¬ä¹‹é—´çš„å…³ç³»

![image-20220901154715911](https://paperrecord.oss-cn-shanghai.aliyuncs.com/image-20220901154715911.png)

å…¶ä¸­$c(v)$ä»£è¡¨äº†å’Œè´Ÿæ ·æœ¬çš„æ¢¯åº¦, è¿™ä¸ªå€¼L2èŒƒæ•°ä¿¡æ¯å¦‚ä¸‹, ç”¨ç›¸ä¼¼åº¦$x=s_u'^Ts_v''$ä»£æ›¿, å¦‚ä¸‹æ‰€ç¤º

![image-20220901154935110](https://paperrecord.oss-cn-shanghai.aliyuncs.com/image-20220901154935110.png)

![image-20220901155019221](https://paperrecord.oss-cn-shanghai.aliyuncs.com/image-20220901155019221.png)

ç”»å‡ºæ¥$\tau = 1, 0.1$çš„å›¾å¦‚ä¸‹, å¯ä»¥çœ‹å‡ºåœ¨0.1æ—¶, ç›¸ä¼¼åº¦è¶Šé«˜çš„è´Ÿæ ·æœ¬çš„æ¢¯åº¦æ›´åŠ é«˜, æœ‰åˆ©äºåŠ é€Ÿè®­ç»ƒ, è€Œç›¸ä¼¼åº¦ä½çš„easy negative sampleåˆ™å‡ ä¹æ²¡æœ‰æ¢¯åº¦.

![image-20220901155103578](https://paperrecord.oss-cn-shanghai.aliyuncs.com/image-20220901155103578.png)

ä¸ºäº†ç ”ç©¶$\tau$çš„å¤§å°, å¯¹g(x)æ±‚å¯¼å¾—åˆ°æœ€å€¼ç‚¹çš„xä¸º$x^*=\frac{\sqrt{\tau^2+4}-\tau}{2}$å¾—åˆ°g(x)çš„æœ€å¤§å€¼ä¸º$g(x^*)$, ç„¶åå–å¯¹æ•°å¦‚ä¸‹æ‰€ç¤º

![image-20220901160116021](https://paperrecord.oss-cn-shanghai.aliyuncs.com/image-20220901160116021.png)

$x^*$å¯¹$\tau$çš„å›¾, $lng(x^*)$å¯¹$\tau$çš„å›¾å¦‚ä¸‹æ‰€ç¤º,éšç€ğœçš„é™ä½ï¼Œå½±å“æœ€å¤§çš„è´ŸèŠ‚ç‚¹ä¸æ­£èŠ‚ç‚¹å˜å¾—æ›´åŠ ç›¸ä¼¼(å³$ğ‘¥^âˆ—$æ¥è¿‘0.9)ï¼Œè€Œä¸”å®ƒä»¬çš„è´¡çŒ®è¢«è¶…æŒ‡æ•°æ”¾å¤§(å³ğ‘”âˆ—æ¥è¿‘ğ‘’8)ã€‚å› æ­¤ï¼Œæ­£ç¡®è®¾ç½®ğœä½¿SGLèƒ½å¤Ÿè‡ªåŠ¨æ‰§è¡Œç¡¬è´ŸæŒ–æ˜ã€‚

![image-20220901160235659](https://paperrecord.oss-cn-shanghai.aliyuncs.com/image-20220901160235659.png)



**å®éªŒç»“æœ**:  

å¤ç°å›æ¥è¡¥, SELFRecæœ‰

**ä¸ªäººæ€»ç»“**ï¼š  

å›¾å¯¹æ¯”çš„ç»å…¸æ–‡ç« , è¯´å®è¯æ¨¡å‹æ²¡ä»€ä¹ˆåˆ›æ–°çš„, å°±æ˜¯ä¸€ä¸ªæ•°æ®å¢å¼º

**å¤‡æ³¨**  

